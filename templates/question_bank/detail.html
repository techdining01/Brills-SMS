{% extends 'base.html' %}
{% load static %}

{% block title %}{{ question.text|truncatewords:5 }} - Question Bank{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="row mb-4">
        <div class="col-md-8">
            <h2><i class="bi bi-question-circle"></i> Question Details</h2>
        </div>
        <div class="col-md-4 text-md-end text-start mt-2 mt-md-0">
            <div class="d-flex flex-wrap gap-2 justify-content-md-end justify-content-start">
                <a href="{% url 'dashboards:question_bank_edit' question.id %}" class="btn btn-secondary">
                    <i class="bi bi-pencil"></i> Edit
                </a>
                <a href="{% url 'dashboards:question_bank_list' %}" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-left"></i> Back
                </a>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8">
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Question</h5>
                </div>
                <div class="card-body">
                    <p class="lead">{{ question.text }}</p>
                    
                    {% if question.explanation %}
                    <hr>
                    <div class="bg-light p-3 rounded">
                        <h6>Explanation</h6>
                        <p class="mb-0">{{ question.explanation }}</p>
                    </div>
                    {% endif %}
                </div>
            </div>

            {% if question.choices.all %}
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Choices ({{ question.choices.count }})</h5>
                </div>
                <div class="card-body">
                    <div class="list-group">
                        {% for choice in question.choices.all %}
                        <div class="list-group-item {% if choice.is_correct %}list-group-item-success{% endif %}">
                            <div class="d-flex">
                                <div class="flex-grow-1">
                                    <p class="mb-0">{{ choice.text }}</p>
                                </div>
                                {% if choice.is_correct %}
                                <span class="badge bg-success ms-2">Correct</span>
                                {% endif %}
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            {% endif %}
        </div>

        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">Metadata</h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-6">Type:</dt>
                        <dd class="col-sm-6">
                            <span class="badge bg-info">{{ question.get_question_type_display }}</span>
                        </dd>
                        <dt class="col-sm-6">Category:</dt>
                        <dd class="col-sm-6">
                            <span class="badge bg-secondary">{{ question.category.name }}</span>
                        </dd>
                        <dt class="col-sm-6">Difficulty:</dt>
                        <dd class="col-sm-6">
                            {% if question.difficulty == 'easy' %}
                                <span class="badge bg-success">Easy</span>
                            {% elif question.difficulty == 'medium' %}
                                <span class="badge bg-warning">Medium</span>
                            {% else %}
                                <span class="badge bg-danger">Hard</span>
                            {% endif %}
                        </dd>
                        <dt class="col-sm-6">Status:</dt>
                        <dd class="col-sm-6">
                            {% if question.is_published %}
                                <span class="badge bg-success">Published</span>
                            {% else %}
                                <span class="badge bg-warning">Draft</span>
                            {% endif %}
                        </dd>
                    </dl>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-header">
                    <h5 class="mb-0">Statistics</h5>
                </div>
                <div class="card-body">
                    <dl class="row">
                        <dt class="col-sm-6">Used in:</dt>
                        <dd class="col-sm-6"><strong>0</strong> exams</dd>
                        <dt class="col-sm-6">Attempts:</dt>
                        <dd class="col-sm-6"><strong>0</strong></dd>
                        <dt class="col-sm-6">Correct:</dt>
                        <dd class="col-sm-6"><strong>0%</strong></dd>
                    </dl>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
