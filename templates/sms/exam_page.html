{% extends "base.html" %}

{% block title %}CBT Exam Session {{ session_id }}{% endblock title %}

{% block content %}
    <div class="max-w-4xl mx-auto bg-white p-6 rounded-lg shadow-xl border border-gray-200">
        <h1 class="text-3xl font-extrabold text-blue-800 mb-6 border-b pb-2">
            CBT Examination <span id="subject-title"></span>
        </h1>

        <div id="exam-loading" class="text-center py-10">
            <p class="text-gray-600 text-lg">Loading exam questions securely...</p>
            <div class="mt-4 animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"></div>
        </div>

        <form id="exam-form" class="hidden space-y-8">
            <div id="questions-container"></div>
            
            <div class="mt-10 pt-4 border-t flex justify-between items-center">
                <button type="button" id="heartbeat-status" 
                        class="px-4 py-2 text-sm rounded-full bg-green-100 text-green-700 font-semibold" 
                        disabled>
                    Status: Connected ðŸŸ¢
                </button>

                <button type="submit" 
                        class="px-6 py-3 bg-red-600 text-white font-bold rounded-lg shadow-lg hover:bg-red-700 transition duration-200 focus:outline-none focus:ring-4 focus:ring-red-300">
                    Submit Exam
                </button>
            </div>
        </form>

    </div>
{% endblock content %}

{% block extra_js %}
<script src="{% static 'js/exam_manager.js' %}"></script>
<script>
    // Initialize the manager with context data from Django
    document.addEventListener('DOMContentLoaded', () => {
        new ExamManager({{ session_id }}, "{{ ws_url }}").init();
    });
</script>
{% endblock extra_js %}