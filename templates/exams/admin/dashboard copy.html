{% extends "base.html" %}
{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row">

    <!-- ================= SIDEBAR ================= -->
    <aside class="col-md-2 d-none d-md-block bg-dark text-white min-vh-100 p-0">
      <div class="p-3 border-bottom">
        <h5 class="mb-0">ğŸ“ Brills SMS</h5>
        <small class="text-muted">Admin Control</small>
      </div>

      <ul class="nav flex-column mt-3 sidebar-nav">
        <li class="nav-item">
          <a class="nav-link active text-white" href="{% url 'exams:admin_dashboard' %}">
            ğŸ“Š Dashboard
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="{% url 'accounts:users' %}">
            ğŸ‘¥ Users
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="{% url 'exams:exams' %}">
            ğŸ“ Exams / CBT
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="{% url 'brillspay:product_list' %}">
            ğŸ’³ BrillsPay
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="{% url 'pickups:generate_pickup' %}">
            ğŸ« Pickups
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="{% url 'exams:pta_request_list' %}">
            ğŸ—£ PTA & Broadcast
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-white" href="{% url 'exams:system_logs' %}">
            ğŸ§¾ Logs & Backups
          </a>
        </li>
      </ul>
    </aside>

    <!-- ================= MAIN ================= -->
    <main class="col-md-10 ms-sm-auto px-md-4">

      <!-- TOP BAR -->
      <div class="d-flex justify-content-between align-items-center py-3 border-bottom">
        <h4 class="fw-bold">Admin Dashboard</h4>

        <div class="d-flex align-items-center gap-3">
          {% if request.user.profile_picture %}
            <img src="{{ request.user.profile_picture.url }}"
                 class="rounded-circle"
                 width="40"
                 height="40">
          {% endif %}
          <div>
            <strong>{{ request.user.get_full_name }}</strong><br>
            <small class="text-muted">Administrator</small>
          </div>
        </div>
      </div>

      <!-- ================= STAT CARDS ================= -->
      <div class="row g-3 mt-3">

        <div class="col-md-3">
          <div class="card shadow-sm border-start border-4 border-primary">
            <div class="card-body">
              <h6 class="text-muted">Pending Users</h6>
              <h3>{{ pending_users }}</h3>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card shadow-sm border-start border-4 border-success">
            <div class="card-body">
              <h6 class="text-muted">Active Exams</h6>
              <h3>{{ active_exams }}</h3>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card shadow-sm border-start border-4 border-warning">
            <div class="card-body">
              <h6 class="text-muted">Retake Requests</h6>
              <h3>{{ retake_requests }}</h3>
            </div>
          </div>
        </div>

        <div class="col-md-3">
          <div class="card shadow-sm border-start border-4 border-danger">
            <div class="card-body">
              <h6 class="text-muted">Active Pickups</h6>
              <h3>{{ active_pickups }}</h3>
            </div>
          </div>
        </div>

      </div>

      <!-- ================= SECOND ROW ================= -->
      <div class="row g-3 mt-3">

        <div class="col-md-4">
          <div class="card shadow-sm">
            <div class="card-body">
              <h6 class="mb-2">ğŸ‘¥ Users Overview</h6>
              <ul class="list-unstyled mb-0">
                <li>Students: <strong>{{ students }}</strong></li>
                <li>Parents: <strong>{{ parents }}</strong></li>
                <li>Staff: <strong>{{ staff }}</strong></li>
              </ul>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card shadow-sm">
            <div class="card-body">
              <h6 class="mb-2">ğŸ’³ Payments</h6>
              <p>Total Transactions: <strong>{{ total_transactions }}</strong></p>
              <p class="mb-0">Successful: <strong>{{ successful_payments }}</strong></p>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="card shadow-sm">
            <div class="card-body">
              <h6 class="mb-2">ğŸ—£ PTA</h6>
              <p class="mb-0">Pending Requests: <strong>{{ pending_pta }}</strong></p>
            </div>
          </div>
        </div>

      </div>

      <!-- ================= PLACEHOLDER FOR CHARTS ================= -->
      <div class="row mt-4">
        <div class="col-md-12">
          <div class="card shadow-sm">
            <div class="card-body text-center text-muted">
              ğŸ“ˆ Analytics & charts will appear here
            </div>
          </div>
        </div>
      </div>

    </main>
  </div>
</div>

<style>
.sidebar-nav .nav-link {
  padding: 12px 20px;
  transition: background 0.3s ease;
}
.sidebar-nav .nav-link:hover,
.sidebar-nav .nav-link.active {
  background-color: rgba(255,255,255,0.15);
}
</style>
{% endblock %}
