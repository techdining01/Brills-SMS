{% extends 'base.html' %}

{% load static %}
{% load humanize %}
{% block title %}
{% endblock title %}Payroll | Dashboard{% block content %}


<h2>Payroll Dashboard</h2>

<table class="table">
<tr>
  <th>Month</th>
  <th>Total Staff</th>
  <th>Total Net</th>
  <th>Status</th>
  <th>Actions</th>
</tr>
{% for batch in batches %}
<tr>
  <td>{{ batch.month }}</td>
  <td>{{ batch.count }}</td>
  <td>{{ batch.total_net }}</td>
  <td>{{ batch.status }}</td>
  <td>
    {% if batch.status == 'DRAFT' %}
      <a href="{% url 'approve_batch' batch.id %}" class="btn btn-success">Approve</a>
    {% endif %}
  </td>
</tr>
{% endfor %}
</table>

<script>
fetch("/charts/monthly-payroll/")
  .then(res => res.json())
  .then(data => {
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: data.map(d => d.month),
        datasets: [{ data: data.map(d => d.total) }]
      }
    })
  })
</script>



{% endblock %}


