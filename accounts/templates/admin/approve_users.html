{% extends 'base.html' %}
<option value="">All Roles</option>
{% for key, label in roles %}
<option value="{{ key }}" {% if request.GET.role==key %}selected{% endif %}>{{ label }}</option>
{% endfor %}
</select>
</div>
<div class="col-md-3">
    <button class="btn btn-primary w-100">Filter</button>
</div>
</form>


<form method="post">{% csrf_token %}
    <div class="table-responsive">
        <table class="table table-hover align-middle">
            <thead>
                <tr>
                    <th><input type="checkbox" onclick="toggleAll(this)"></th>
                    <th>Name</th>
                    <th>Role</th>
                    <th>Email</th>
                    <th>Date Joined</th>
                </tr>
            </thead>
            <tbody>
                {% for u in users %}
                <tr>
                    <td><input type="checkbox" name="users" value="{{ u.id }}"></td>
                    <td>{{ u.get_full_name }}</td>
                    <td><span class="badge bg-secondary">{{ u.get_role_display }}</span></td>
                    <td>{{ u.email }}</td>
                    <td>{{ u.date_joined|date:"M d, Y" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5" class="text-center text-muted">No pending users</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>


    <button class="btn btn-success mt-2">Approve Selected</button>
</form>


</div>
</div>
</div>


<script>
    function toggleAll(source) {
        document.querySelectorAll('input[name="users"]').forEach(cb => cb.checked = source.checked)
    }
</script>
{% endblock %}